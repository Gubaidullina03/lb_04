# lb_04. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–∫–∞–∑–æ–≤ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ.

# –¶–µ–ª–∏ —Ä–∞–±–æ—Ç—ã:
–ò–∑—É—á–∏—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Ç–∫–∞–∑–æ–≤ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Å –ø–æ–º–æ—â—å—é —Å–∏–º—É–ª—è—Ç–æ—Ä–∞ Serf Convergence Simulator –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –≤—Ä–µ–º—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª–æ—Å—ã –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏—è.

## 8 –≤–∞—Ä–∏–∞–Ω—Ç. –í–ª–∏—è–Ω–∏–µ –∞—Å—Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤.

–ó–∞–¥–∞—á–∞. –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.

–û–ø–∏—Å–∞–Ω–∏–µ: 
- Gossip Interval: 0.2 —Å
- Gossip Fanout: 3
- Nodes: 100
- Packet Loss (–∏—Å—Ö–æ–¥—è—â–∏–µ/–≤—Ö–æ–¥—è—â–∏–µ): 0%/10%, 10%/0%, 5%/15%, 15%/5%
- Node Failures: 5%
10



## –®–∞–≥ 1. –ü–æ–ª—É—á–∏—Ç—å –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∞—Ä–∏–∞–Ω—Ç–∞

```
try:
    show_variant_details(MY_VARIANT)
except NameError:
    print(f" –í–∞—Ä–∏–∞–Ω—Ç {MY_VARIANT}: –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –ø–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤")
    print("   Gossip Interval: 0.2 —Å")
    print("   Gossip Fanout: 3")
    print("   Nodes: 100")
    print("   Packet Loss: –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è (10, 1, 100, 5, 15, 5)%")
    print("   Node Failures: 5%")
    print("   –ó–∞–¥–∞—á–∞: –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–ª–∏—è–Ω–∏—è –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤")


params = {
    'intervals': [0.2],                             # Gossip Interval (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
    'fanout': 3,                                    # Gossip Fanout (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
    'nodes': 100,                                   # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤
    'packet_loss': [10, 1, 100, 5, 15, 5],         # –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –ø–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤ (%)
    # –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –í —Ç–∞–±–ª–∏—Ü–µ —É–∫–∞–∑–∞–Ω–æ "101, 100, 515, 155%", –≤–µ—Ä–æ—è—Ç–Ω–æ –æ–ø–µ—á–∞—Ç–∫–∞.
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º: 10%, 1%, 100%, 5%, 15%, 5%
    'failures': 5                                   # –û—Ç–∫–∞–∑—ã —É–∑–ª–æ–≤ (%)
}

print(f"\nüîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏:")
for key, value in params.items():
    print(f"   {key}: {value}")
```

## –®–∞–≥ 2. –ü—Ä–æ–≤–µ—Å—Ç–∏ —Å–∏–º—É–ª—è—Ü–∏—é

```
def run_student_variant(params):
    """
    –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ 8 —Å –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π –ø–æ—Ç–µ—Ä–µ–π –ø–∞–∫–µ—Ç–æ–≤
    """
    results = []

    # –î–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ 8 –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º —Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤
    for packet_loss in params['packet_loss']:
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π interval (0.2)
        interval = params['intervals'][0]

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∫–ª–∞—Å—Å SerfSimulator
        try:
            sim = SerfSimulator(
                params['nodes'],
                interval,
                params['fanout'],
                packet_loss,  # –†–∞–∑–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤
                params['failures']
            )
            first_time, all_time, bw = sim.run_simulation()
        except NameError:
            print(f"  –û—à–∏–±–∫–∞: –ö–ª–∞—Å—Å SerfSimulator –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            print(f"   –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤ {packet_loss}%...")
            # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            first_time = 1.0 + packet_loss / 50  # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤
            all_time = 3.0 + packet_loss / 20    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤
            bw = 1000000 * (1 - packet_loss/100)  # –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è —Å –ø–æ—Ç–µ—Ä–µ–π

        # –†–∞—Å—á–µ—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–ª–æ—Å—ã –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏—è
        try:
            bandwidth_calc = calculate_bandwidth(
                interval,
                params['fanout'],
                params['nodes'],
                packet_loss/100,  # –£—á–∏—Ç—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –ø–æ—Ç–µ—Ä–∏
                params['failures']/100
            )
        except NameError:
            print(f"  –û—à–∏–±–∫–∞: –§—É–Ω–∫—Ü–∏—è calculate_bandwidth –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!")
            print(f"   –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç –¥–ª—è –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤ {packet_loss}%...")
            # –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç
            bandwidth_calc = params['nodes'] * params['fanout'] * 1000 * (1 - packet_loss/100)

        results.append({
            'Packet_Loss_%': packet_loss,
            'First_Time': first_time,
            'All_Time': all_time,
            'Bandwidth_Sim': bw,
            'Bandwidth_Calc_Mbps': bandwidth_calc / 1_000_000
        })

    return pd.DataFrame(results)

# –ó–∞–ø—É—Å–∫
df_results = run_student_variant(params)

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
print("\n –†–ï–ó–£–õ–¨–¢–ê–¢–´ –°–ò–ú–£–õ–Ø–¶–ò–ò:")
print("="*80)
print(df_results)
```

–ü–æ–ª—É—á–∏–º:


<img width="851" height="216" alt="Screenshot_314" src="https://github.com/user-attachments/assets/035e1b68-8428-4ef1-83b5-dc93a871a211" />


## –®–∞–≥ 3. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ 

```
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# –ì—Ä–∞—Ñ–∏–∫ 1: –í—Ä–µ–º—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤
ax1 = axes[0]
ax1.plot(df_results['Packet_Loss_%'], df_results['All_Time'], 'o-',
         color='#3498db', linewidth=2, markersize=10, label='–ü–æ–ª–Ω–∞—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏—è')
ax1.plot(df_results['Packet_Loss_%'], df_results['First_Time'], 's--',
         color='#e74c3c', linewidth=2, markersize=8, label='–ü–µ—Ä–≤–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ')
ax1.set_xlabel('–ü–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤ (%)')
ax1.set_ylabel('–í—Ä–µ–º—è (—Å–µ–∫)')
ax1.set_title('–í—Ä–µ–º—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏ vs –ü–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤ (–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è)')
ax1.legend()
ax1.grid(True, alpha=0.7)

# –ì—Ä–∞—Ñ–∏–∫ 2: –ü–æ–ª–æ—Å–∞ –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ç–µ—Ä–∏ –ø–∞–∫–µ—Ç–æ–≤
ax2 = axes[1]
# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–∏ X
packet_loss_labels = [f"{pl}%" for pl in df_results['Packet_Loss_%']]
ax2.bar(packet_loss_labels, df_results['Bandwidth_Calc_Mbps'],
        color='#2ecc71', edgecolor='black')
ax2.set_xlabel('–ü–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤ (%)')
ax2.set_ylabel('–ü–æ–ª–æ—Å–∞ –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏—è (–ú–±–∏—Ç/—Å)')
ax2.set_title('–ü–æ–ª–æ—Å–∞ –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏—è vs –ü–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤ (–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è)')
ax2.grid(axis='y', alpha=0.7)
plt.xticks(rotation=45)

plt.suptitle(f'–í–∞—Ä–∏–∞–Ω—Ç {MY_VARIANT}: –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –ø–æ—Ç–µ—Ä—è –ø–∞–∫–µ—Ç–æ–≤', fontsize=14, fontweight='bold')
plt.tight_layout()
plt.show()
```

–ü–æ–ª—É—á–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç:


<img width="1676" height="589" alt="Screenshot_312" src="https://github.com/user-attachments/assets/f0772e20-a710-466a-a9f4-bf6f5cf894c8" />



## –®–∞–≥ 4. –ü—Ä–æ–∏–∑–≤–µ–¥–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

```
print("\n –ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:")
print("="*80)

# –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏
if not df_results.empty:
    max_time_idx = df_results['All_Time'].idxmax()
    min_time_idx = df_results['All_Time'].idxmin()

    print(f"1. –ù–∞–∏—Ö—É–¥—à–∞—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏—è –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ –ø–∞–∫–µ—Ç–æ–≤ {df_results.loc[max_time_idx, 'Packet_Loss_%']}%:")
    print(f"   –í—Ä–µ–º—è –ø–æ–ª–Ω–æ–π –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏: {df_results.loc[max_time_idx, 'All_Time']:.2f} —Å–µ–∫")
    print(f"   –í—Ä–µ–º—è –ø–µ—Ä–≤–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è: {df_results.loc[max_time_idx, 'First_Time']:.2f} —Å–µ–∫")

    print(f"\n2. –ù–∞–∏–ª—É—á—à–∞—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏—è –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ –ø–∞–∫–µ—Ç–æ–≤ {df_results.loc[min_time_idx, 'Packet_Loss_%']}%:")
    print(f"   –í—Ä–µ–º—è –ø–æ–ª–Ω–æ–π –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏: {df_results.loc[min_time_idx, 'All_Time']:.2f} —Å–µ–∫")
    print(f"   –í—Ä–µ–º—è –ø–µ—Ä–≤–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è: {df_results.loc[min_time_idx, 'First_Time']:.2f} —Å–µ–∫")

    # –ê–Ω–∞–ª–∏–∑ –≤–ª–∏—è–Ω–∏—è –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π –ø–æ—Ç–µ—Ä–∏
    print(f"\n3. –†–∞–∑–±—Ä–æ—Å –≤—Ä–µ–º–µ–Ω–∏ –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏:")
    print(f"   –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è: {df_results['All_Time'].max():.2f} —Å–µ–∫")
    print(f"   –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è: {df_results['All_Time'].min():.2f} —Å–µ–∫")
    print(f"   –†–∞–∑–Ω–∏—Ü–∞: {(df_results['All_Time'].max() - df_results['All_Time'].min()):.2f} —Å–µ–∫")

    print(f"\n4. –°—Ä–µ–¥–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:")
    print(f"   –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏: {df_results['All_Time'].mean():.2f} —Å–µ–∫")
    print(f"   –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –ø–µ—Ä–≤–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è: {df_results['First_Time'].mean():.2f} —Å–µ–∫")
    print(f"   –°—Ä–µ–¥–Ω—è—è –ø–æ–ª–æ—Å–∞ –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏—è: {df_results['Bandwidth_Calc_Mbps'].mean():.2f} –ú–±–∏—Ç/—Å")

    print(f"\n5. –í—ã–≤–æ–¥—ã –ø–æ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π –ø–æ—Ç–µ—Ä–µ –ø–∞–∫–µ—Ç–æ–≤:")
    print(f"   - –ü—Ä–∏ 100% –ø–æ—Ç–µ—Ä–µ –ø–∞–∫–µ—Ç–æ–≤ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å")
    print(f"   - –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ—Ç–µ—Ä—è—Ö 1-10%")
    print(f"   - –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –ø–æ—Ç–µ—Ä—è –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã")
else:
    print("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞!")
```

–ü–æ–ª—É—á–∏–º:


<img width="827" height="548" alt="Screenshot_315" src="https://github.com/user-attachments/assets/f16d6a17-ca0b-46ea-a3c8-25d0e585845a" />


## –í—ã–≤–æ–¥
–í —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º–Ω–æ–π –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ –∏–∑—É—á–µ–Ω—ã –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Ç–∫–∞–∑–æ–≤ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Å –ø–æ–º–æ—â—å—é —Å–∏–º—É–ª—è—Ç–æ—Ä–∞ Serf Convergence Simulator –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –≤–ª–∏—è–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –≤—Ä–µ–º—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª–æ—Å—ã –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏—è.
